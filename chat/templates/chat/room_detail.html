{% extends 'base.html' %}

{% block main_content %}
<h1>{{ room.name }}</h1>

<!-- Display messages -->
<div>
  {% for message in messages %}
    <div style="margin-bottom: 1em;">
      <strong>{{ message.sender.username }}:</strong>
      {% if message.image %}
        <!-- If there's an image, show it -->
        {{ message.content }}
        <br>
        <a href="{{ message.image.url }}" target="_blank">
            <img 
              src="{{ message.image.url }}" 
              alt="Image from {{ message.sender.username }}" 
              style="max-width: 200px;"
            />
          </a>
      {% else %}
        <!-- Otherwise, just show the text -->
        {{ message.content }}
      {% endif %}
      <br>
      <small>{{ message.created_at|date:"d M Y H:i" }}</small>
    </div>
  {% endfor %}
</div>

<!-- Message form -->
<form method="POST" enctype="multipart/form-data">
  {% csrf_token %}
  {{ message_form.non_field_errors }}

  <p>
    {{ message_form.content.label_tag }}<br>
    {{ message_form.content }}
    {{ message_form.content.errors }}
  </p>

  <p>
    {{ message_form.image.label_tag }}<br>
    {{ message_form.image }}
    {{ message_form.image.errors }}
  </p>

  <button type="submit">Send</button>
</form>
{% endblock %}
